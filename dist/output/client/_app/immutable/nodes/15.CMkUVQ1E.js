import"../chunks/Bg9kRutz.js";import"../chunks/S6wLSpnM.js";import{p as $e,t as j,b as Ee,s as d,c as r,d as l,g as e,m as c,r as o,i as je}from"../chunks/CPz9NqMD.js";import{s as A}from"../chunks/Btzz-3rd.js";import{i as G,r as Ye,e as Y}from"../chunks/DM5mFc0n.js";import{e as Fe,i as Ne}from"../chunks/C1cPdbVw.js";import{a as y,t as x}from"../chunks/CnZq424f.js";import{r as ie}from"../chunks/CNcTiupO.js";import{b as O}from"../chunks/Bobbsvk_.js";import{b as Se}from"../chunks/BCc680BQ.js";import{p as Ie}from"../chunks/CWmzcjye.js";import{i as Ue}from"../chunks/CxZb-nwJ.js";import{p as Te}from"../chunks/KiyYLvU9.js";import{o as Ce}from"../chunks/CTsj7Z0s.js";import{g as V}from"../chunks/B2XhxK2B.js";import{a as k}from"../chunks/upsvKRUO.js";import{I as Le,a as Me,g as Be}from"../chunks/DlQj9-fi.js";import{N as v}from"../chunks/DzgOfrvm.js";const Pe=({params:F})=>({slug:F.slug}),pt=Object.freeze(Object.defineProperty({__proto__:null,load:Pe},Symbol.toStringTag,{value:"Module"}));var Re=x('<div class="flex justify-center items-center h-64"><div class="flex flex-col items-center space-y-3"><div class="w-10 h-10 border-3 border-blue-500/50 border-t-blue-500 rounded-full animate-spin"></div> <p class="text-gray-400 text-sm">Loading notice data...</p></div></div>'),qe=x('<div class="flex items-center justify-between p-3 bg-gray-700/30 rounded-lg" id="existingFiles"><span class="text-sm text-gray-300 truncate flex-1"> </span> <button type="button" class="ml-2 p-1.5 text-gray-400 hover:text-red-400 rounded-lg hover:bg-gray-700/50 transition-colors"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div>'),ze=x('<div class="space-y-2"><label for="existingFiles" class="block text-sm font-medium text-gray-300">Existing Files</label> <div class="space-y-2"></div></div>'),Ae=x('<div class="flex justify-center items-center py-2"><div class="w-8 h-8 border-3 border-blue-500/50 border-t-blue-500 rounded-full animate-spin"></div> <span class="ml-2 text-gray-300">Uploading files...</span></div>'),Ge=x('<form class="p-6 space-y-6"><div class="space-y-2"><label for="title" class="block text-sm font-medium text-gray-300">Notice Title</label> <input type="text" id="title" placeholder="Enter notice title" class="w-full px-4 py-2.5 bg-gray-700/50 text-white rounded-xl border border-gray-600/50 focus:border-blue-500/50 focus:ring-2 focus:ring-blue-500/20 placeholder-gray-400"></div> <div class="space-y-2"><label for="date" class="block text-sm font-medium text-gray-300">Date</label> <input type="date" id="date" class="w-full px-4 py-2.5 bg-gray-700/50 text-white rounded-xl border border-gray-600/50 focus:border-blue-500/50 focus:ring-2 focus:ring-blue-500/20"></div> <div class="space-y-2"><label for="content" class="block text-sm font-medium text-gray-300">Content</label> <textarea id="content" rows="6" placeholder="Enter notice content" class="w-full px-4 py-2.5 bg-gray-700/50 text-white rounded-xl border border-gray-600/50 focus:border-blue-500/50 focus:ring-2 focus:ring-blue-500/20 placeholder-gray-400"></textarea></div> <div class="space-y-2"><label for="year" class="block text-sm font-medium text-gray-300">Year</label> <select id="year" class="w-full px-4 py-2.5 bg-gray-700/50 text-white rounded-xl border border-gray-600/50 focus:border-blue-500/50 focus:ring-2 focus:ring-blue-500/20"><option disabled>Select year</option><option>1st Year</option><option>2nd Year</option></select></div> <!> <div class="space-y-2"><label for="file" class="block text-sm font-medium text-gray-300">Upload New Files</label> <input type="file" id="file" multiple accept=".jpg,.jpeg,.png,.pdf" class="block w-full text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-medium file:bg-blue-500/10 file:text-blue-400 hover:file:bg-blue-500/20 cursor-pointer"></div> <!> <div class="flex gap-4 pt-4"><button type="button" class="flex-1 px-4 py-2.5 bg-gray-700 hover:bg-gray-600 text-gray-300 font-medium rounded-xl transition-colors duration-200">Cancel</button> <button type="submit" class="flex-1 px-4 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-medium rounded-xl hover:from-blue-600 hover:to-blue-700 focus:ring-2 focus:ring-blue-500/20 transition-all duration-200 disabled:opacity-50"> </button></div></form>'),Oe=x('<div class="min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900 py-8 px-4"><div class="max-w-2xl mx-auto"><div class="bg-gray-800/40 backdrop-blur-sm rounded-2xl shadow-xl border border-gray-700/50 overflow-hidden"><div class="bg-gray-800/60 border-b border-gray-700/50 px-6 py-4"><h2 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-400">Update Notice</h2> <p class="text-gray-400 mt-1"> </p></div> <!></div></div></div>');function ut(F,H){$e(H,!1);const D=Te(H,"data",8)().slug;let J=c(""),m=c(""),b=c(""),g=c(""),p=c(""),K="",N=[],u=c([]),S=[],_=c(!1),Q=c(!0);const ne="djqao3rbs",de="ndc14-web-project";function I(){const a=localStorage.getItem("jwtToken");if(a&&a.length>0&&Le(a)&&!Me(a)){const t=Be(a);return K=t,t}else V("/login")}Ce(async()=>{var a;try{I();const t=await k.get(`https://ndc14backend.onrender.com/api/v2/users/id/${K}`);d(J,t.data.data.fullName);const s=(await k.get(`https://ndc14backend.onrender.com/api/v2/notices/${D}`)).data.data;d(m,s.title),d(g,s.content),d(p,s.year===1?"1st Year":"2nd Year");const[f,$,h]=s.date.split("/");d(b,`${h}-${$.padStart(2,"0")}-${f.padStart(2,"0")}`),d(u,((a=s.files)==null?void 0:a.map(E=>E.filename))||[])}catch(t){console.error("Error fetching data:",t),v("Error loading notice data","error")}finally{d(Q,!1)}});function ce(a){const t=a.target;t&&t.files&&(S=Array.from(t.files))}async function pe(){N=[],d(_,!0);const a=S.map(async t=>{const i=new FormData;i.append("file",t),i.append("upload_preset",de);try{const f=await(await k.post(`https://api.cloudinary.com/v1_1/${ne}/auto/upload`,i,{headers:{"Content-Type":"multipart/form-data"},params:{resource_type:"auto",chunk_size:6e6}})).data;N.push(f.secure_url),await v(`Updated file: ${t.name}`,"success")}catch(s){console.error(`Error uploading file: ${t.name}`,s)}});await Promise.all(a),d(_,!1)}async function ue(a){if(a.preventDefault(),!e(m)||!e(b)||!e(g)||!e(p)){v("All fields are required","error");return}const t=new Date(e(b)).toLocaleDateString("en-GB").replace(/\//g,"/");let i={title:e(m),date:t,updated_by:I(),content:e(g),year:e(p)==="1st Year"?1:2,files:e(u).map(s=>({filename:s}))};try{S.length>0&&(await pe(),i.files=N.map(s=>({filename:s}))),await k.put(`https://ndc14backend.onrender.com/api/v2/notices/${D}`,i),v("Notice updated successfully!","success"),V(`/dashboard/notices/${D}`)}catch(s){console.error("Error updating notice:",s),v("Error updating notice","error")}}async function fe(a){try{d(u,e(u).filter(i=>i!==a));const t={title:e(m),updated_by:I(),date:new Date(e(b)).toLocaleDateString("en-GB").replace(/\//g,"/"),content:e(g),year:e(p)==="1st Year"?1:2,files:e(u).map(i=>({filename:i}))};await k.put(`https://ndc14backend.onrender.com/api/v2/notices/${D}`,t),v("File removed","success")}catch(t){console.error("Error removing file:",t),v("Error removing file","error")}}Ue();var U=Oe(),W=l(U),X=l(W),T=l(X),Z=r(l(T),2),ve=l(Z);o(Z),o(T);var me=r(T,2);{var be=a=>{var t=Re();y(a,t)},ge=a=>{var t=Ge(),i=l(t),s=r(l(i),2);ie(s),o(i);var f=r(i,2),$=r(l(f),2);ie($),o(f);var h=r(f,2),E=r(l(h),2);Ye(E),o(h);var C=r(h,2),L=r(l(C),2);j(()=>{e(p),je(()=>{})});var M=l(L);M.value=((M.__value="")==null,"");var B=r(M);B.value=(B.__value="1st Year")==null?"":"1st Year";var ee=r(B);ee.value=(ee.__value="2nd Year")==null?"":"2nd Year",o(L),o(C);var te=r(C,2);{var ye=n=>{var w=ze(),se=r(l(w),2);Fe(se,5,()=>e(u),Ne,(we,le)=>{var q=qe(),z=l(q),ke=l(z,!0);j(()=>A(ke,e(le).split("/").pop())),o(z);var De=r(z,2);o(q),Y("click",De,()=>fe(e(le))),y(we,q)}),o(se),o(w),y(n,w)};G(te,n=>{e(u).length>0&&n(ye)})}var P=r(te,2),xe=r(l(P),2);o(P);var ae=r(P,2);{var _e=n=>{var w=Ae();y(n,w)};G(ae,n=>{e(_)&&n(_e)})}var re=r(ae,2),oe=l(re),R=r(oe,2),he=l(R,!0);o(R),o(re),o(t),j(()=>{R.disabled=e(_),A(he,e(_)?"Updating...":"Update Notice")}),O(s,()=>e(m),n=>d(m,n)),O($,()=>e(b),n=>d(b,n)),O(E,()=>e(g),n=>d(g,n)),Se(L,()=>e(p),n=>d(p,n)),Y("change",xe,ce),Y("click",oe,()=>V("/dashboard/notices")),Y("submit",t,Ie(ue)),y(a,t)};G(me,a=>{e(Q)?a(be):a(ge,!1)})}o(X),o(W),o(U),j(()=>A(ve,`Editor: ${e(J)??""}`)),y(F,U),Ee()}export{ut as component,pt as universal};
