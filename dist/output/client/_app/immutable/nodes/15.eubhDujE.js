import"../chunks/Bg9kRutz.js";import"../chunks/CZwOOZ8X.js";import{p as je,l as Ue,b as Ye,t as j,c as Fe,g as e,s as d,d as r,e as l,m as c,r as o,j as Ie}from"../chunks/C49fxnTX.js";import{s as G}from"../chunks/CpG_a03V.js";import{i as O,r as Le,e as U}from"../chunks/Cd7jppo2.js";import{e as Ne,i as Be}from"../chunks/6_bSFVyE.js";import{a as y,t as x}from"../chunks/BVyY2eYF.js";import{r as de}from"../chunks/C55JGdRg.js";import{b as V}from"../chunks/DY5b5QkI.js";import{b as Re}from"../chunks/BYitliNK.js";import{p as Ae}from"../chunks/CWmzcjye.js";import{i as Te}from"../chunks/Dza9i49Z.js";import{p as Ce}from"../chunks/yqPa7dZW.js";import{s as Me,a as Pe}from"../chunks/CZe-tk6V.js";import{o as qe}from"../chunks/rzUrWnQ3.js";import{g as H}from"../chunks/DkGKsnCd.js";import{a as D,B as ze}from"../chunks/D4POEFCI.js";import{I as Ge,a as Oe,g as Ve}from"../chunks/DlQj9-fi.js";import{N as v}from"../chunks/DzgOfrvm.js";const He=({params:Y})=>({slug:Y.slug}),_t=Object.freeze(Object.defineProperty({__proto__:null,load:He},Symbol.toStringTag,{value:"Module"}));var Je=x('<div class="flex justify-center items-center h-64"><div class="flex flex-col items-center space-y-3"><div class="w-10 h-10 border-3 border-blue-500/50 border-t-blue-500 rounded-full animate-spin"></div> <p class="text-gray-400 text-sm">Loading notice data...</p></div></div>'),Ke=x('<div class="flex items-center justify-between p-3 bg-gray-700/30 rounded-lg" id="existingFiles"><span class="text-sm text-gray-300 truncate flex-1"> </span> <button type="button" class="ml-2 p-1.5 text-gray-400 hover:text-red-400 rounded-lg hover:bg-gray-700/50 transition-colors"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div>'),Qe=x('<div class="space-y-2"><label for="existingFiles" class="block text-sm font-medium text-gray-300">Existing Files</label> <div class="space-y-2"></div></div>'),We=x('<div class="flex justify-center items-center py-2"><div class="w-8 h-8 border-3 border-blue-500/50 border-t-blue-500 rounded-full animate-spin"></div> <span class="ml-2 text-gray-300">Uploading files...</span></div>'),Xe=x('<form class="p-6 space-y-6"><div class="space-y-2"><label for="title" class="block text-sm font-medium text-gray-300">Notice Title</label> <input type="text" id="title" placeholder="Enter notice title" class="w-full px-4 py-2.5 bg-gray-700/50 text-white rounded-xl border border-gray-600/50 focus:border-blue-500/50 focus:ring-2 focus:ring-blue-500/20 placeholder-gray-400"></div> <div class="space-y-2"><label for="date" class="block text-sm font-medium text-gray-300">Date</label> <input type="date" id="date" class="w-full px-4 py-2.5 bg-gray-700/50 text-white rounded-xl border border-gray-600/50 focus:border-blue-500/50 focus:ring-2 focus:ring-blue-500/20"></div> <div class="space-y-2"><label for="content" class="block text-sm font-medium text-gray-300">Content</label> <textarea id="content" rows="6" placeholder="Enter notice content" class="w-full px-4 py-2.5 bg-gray-700/50 text-white rounded-xl border border-gray-600/50 focus:border-blue-500/50 focus:ring-2 focus:ring-blue-500/20 placeholder-gray-400"></textarea></div> <div class="space-y-2"><label for="year" class="block text-sm font-medium text-gray-300">Year</label> <select id="year" class="w-full px-4 py-2.5 bg-gray-700/50 text-white rounded-xl border border-gray-600/50 focus:border-blue-500/50 focus:ring-2 focus:ring-blue-500/20"><option disabled>Select year</option><option>1st Year</option><option>2nd Year</option></select></div> <!> <div class="space-y-2"><label for="file" class="block text-sm font-medium text-gray-300">Upload New Files</label> <input type="file" id="file" multiple accept=".jpg,.jpeg,.png,.pdf" class="block w-full text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-medium file:bg-blue-500/10 file:text-blue-400 hover:file:bg-blue-500/20 cursor-pointer"></div> <!> <div class="flex gap-4 pt-4"><button type="button" class="flex-1 px-4 py-2.5 bg-gray-700 hover:bg-gray-600 text-gray-300 font-medium rounded-xl transition-colors duration-200">Cancel</button> <button type="submit" class="flex-1 px-4 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-medium rounded-xl hover:from-blue-600 hover:to-blue-700 focus:ring-2 focus:ring-blue-500/20 transition-all duration-200 disabled:opacity-50"> </button></div></form>'),Ze=x('<div class="min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900 py-8 px-4"><div class="max-w-2xl mx-auto"><div class="bg-gray-800/40 backdrop-blur-sm rounded-2xl shadow-xl border border-gray-700/50 overflow-hidden"><div class="bg-gray-800/60 border-b border-gray-700/50 px-6 py-4"><h2 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-400">Update Notice</h2> <p class="text-gray-400 mt-1"> </p></div> <!></div></div></div>');function ht(Y,J){je(J,!1);const ce=Me(),K=()=>Pe(ze,"$BASE_URL",ce);let _=c("");const $=Ce(J,"data",8)().slug;let Q=c(""),g=c(""),m=c(""),b=c(""),p=c(""),W="",F=[],u=c([]),I=[],h=c(!1),X=c(!0);const pe="djqao3rbs",ue="ndc14-web-project";function L(){const a=localStorage.getItem("jwtToken");if(a&&a.length>0&&Ge(a)&&!Oe(a)){const t=Ve(a);return W=t,t}else H("/login")}qe(async()=>{var a;try{L();const t=await D.get(`${(await e(_)).toString()}/users/id/${W}`);d(Q,t.data.data.fullName);const s=(await D.get(`${(await e(_)).toString()}/notices/${$}`)).data.data;d(g,s.title),d(b,s.content),d(p,s.year===1?"1st Year":"2nd Year");const[f,S,w]=s.date.split("/");d(m,`${w}-${S.padStart(2,"0")}-${f.padStart(2,"0")}`),d(u,((a=s.files)==null?void 0:a.map(E=>E.filename))||[])}catch(t){console.error("Error fetching data:",t),v("Error loading notice data","error")}finally{d(X,!1)}});function fe(a){const t=a.target;t&&t.files&&(I=Array.from(t.files))}async function ve(){F=[],d(h,!0);const a=I.map(async t=>{const i=new FormData;i.append("file",t),i.append("upload_preset",ue);try{const f=await(await D.post(`https://api.cloudinary.com/v1_1/${pe}/auto/upload`,i,{headers:{"Content-Type":"multipart/form-data"},params:{resource_type:"auto",chunk_size:6e6}})).data;F.push(f.secure_url),await v(`Updated file: ${t.name}`,"success")}catch(s){console.error(`Error uploading file: ${t.name}`,s)}});await Promise.all(a),d(h,!1)}async function ge(a){if(a.preventDefault(),!e(g)||!e(m)||!e(b)||!e(p)){v("All fields are required","error");return}const t=new Date(e(m)).toLocaleDateString("en-GB").replace(/\//g,"/");let i={title:e(g),date:t,updated_by:L(),content:e(b),year:e(p)==="1st Year"?1:2,files:e(u).map(s=>({filename:s}))};try{I.length>0&&(await ve(),i.files=F.map(s=>({filename:s}))),await D.put(`${(await e(_)).toString()}/notices/${$}`,i),v("Notice updated successfully!","success"),H(`/dashboard/notices/${$}`)}catch(s){console.error("Error updating notice:",s),v("Error updating notice","error")}}async function me(a){try{d(u,e(u).filter(i=>i!==a));const t={title:e(g),updated_by:L(),date:new Date(e(m)).toLocaleDateString("en-GB").replace(/\//g,"/"),content:e(b),year:e(p)==="1st Year"?1:2,files:e(u).map(i=>({filename:i}))};await D.put(`${(await e(_)).toString()}/notices/${$}`,t),v("File removed","success")}catch(t){console.error("Error removing file:",t),v("Error removing file","error")}}Ue(()=>K(),()=>{d(_,K())}),Ye(),Te();var N=Ze(),Z=l(N),ee=l(Z),B=l(ee),te=r(l(B),2),be=l(te);o(te),o(B);var ye=r(B,2);{var xe=a=>{var t=Je();y(a,t)},_e=a=>{var t=Xe(),i=l(t),s=r(l(i),2);de(s),o(i);var f=r(i,2),S=r(l(f),2);de(S),o(f);var w=r(f,2),E=r(l(w),2);Le(E),o(w);var R=r(w,2),A=r(l(R),2);j(()=>{e(p),Ie(()=>{})});var T=l(A);T.value=((T.__value="")==null,"");var C=r(T);C.value=(C.__value="1st Year")==null?"":"1st Year";var ae=r(C);ae.value=(ae.__value="2nd Year")==null?"":"2nd Year",o(A),o(R);var re=r(R,2);{var he=n=>{var k=Qe(),ie=r(l(k),2);Ne(ie,5,()=>e(u),Be,($e,ne)=>{var q=Ke(),z=l(q),Se=l(z,!0);j(()=>G(Se,e(ne).split("/").pop())),o(z);var Ee=r(z,2);o(q),U("click",Ee,()=>me(e(ne))),y($e,q)}),o(ie),o(k),y(n,k)};O(re,n=>{e(u).length>0&&n(he)})}var M=r(re,2),we=r(l(M),2);o(M);var oe=r(M,2);{var ke=n=>{var k=We();y(n,k)};O(oe,n=>{e(h)&&n(ke)})}var se=r(oe,2),le=l(se),P=r(le,2),De=l(P,!0);o(P),o(se),o(t),j(()=>{P.disabled=e(h),G(De,e(h)?"Updating...":"Update Notice")}),V(s,()=>e(g),n=>d(g,n)),V(S,()=>e(m),n=>d(m,n)),V(E,()=>e(b),n=>d(b,n)),Re(A,()=>e(p),n=>d(p,n)),U("change",we,fe),U("click",le,()=>H("/dashboard/notices")),U("submit",t,Ae(ge)),y(a,t)};O(ye,a=>{e(X)?a(xe):a(_e,!1)})}o(ee),o(Z),o(N),j(()=>G(be,`Editor: ${e(Q)??""}`)),y(Y,N),Fe()}export{ht as component,_t as universal};
