import"../chunks/Bg9kRutz.js";import"../chunks/S6wLSpnM.js";import{p as se,t as G,b as ne,s as i,c as r,d as o,g as a,m as d,r as l,i as de}from"../chunks/CPz9NqMD.js";import{s as ce}from"../chunks/Btzz-3rd.js";import{i as L,e as M,r as pe}from"../chunks/DM5mFc0n.js";import{a as v,t as J,b as V}from"../chunks/CnZq424f.js";import{r as H}from"../chunks/CNcTiupO.js";import{b as T}from"../chunks/Bobbsvk_.js";import{b as ue}from"../chunks/BCc680BQ.js";import{p as fe}from"../chunks/CWmzcjye.js";import{i as me}from"../chunks/CxZb-nwJ.js";import{o as be}from"../chunks/CTsj7Z0s.js";import{g as ge}from"../chunks/B2XhxK2B.js";import{a as F}from"../chunks/upsvKRUO.js";import{I as ve,a as ye,g as xe}from"../chunks/DlQj9-fi.js";import{N as u}from"../chunks/DzgOfrvm.js";var _e=J('<div class="flex justify-center items-center"><div class="border-t-4 border-blue-500 w-8 h-8 mx-auto animate-spin rounded-full"></div> <span class="ml-2 text-white">Uploading...</span></div>'),he=J('<div class="min-h-screen bg-gradient-to-b from-gray-900 to-gray-800 flex items-center justify-center py-8"><div class="w-full max-w-lg bg-gray-800/80 p-6 rounded-2xl shadow-lg border border-gray-700/50"><h2 class="text-2xl font-bold text-white mb-6 text-center">Add New Notice</h2> <p class="text-gray-400 text-center mb-6"> </p> <form class="space-y-6"><div><label for="title" class="block text-gray-400 font-medium mb-2">Notice Title</label> <input type="text" placeholder="Enter notice title" class="w-full px-4 py-3 bg-gray-700/50 text-white rounded-xl border border-gray-600 focus:ring-2 focus:ring-blue-500 focus:outline-none"></div> <div><label for="date" class="block text-gray-400 font-medium mb-2">Date</label> <input type="date" class="w-full px-4 py-3 bg-gray-700/50 text-white rounded-xl border border-gray-600 focus:ring-2 focus:ring-blue-500 focus:outline-none"></div> <div><label for="content" class="block text-gray-400 font-medium mb-2">Content</label> <textarea rows="4" placeholder="Enter notice content" class="w-full px-4 py-3 bg-gray-700/50 text-white rounded-xl border border-gray-600 focus:ring-2 focus:ring-blue-500 focus:outline-none"></textarea></div> <div><label for="year" class="block text-gray-400 font-medium mb-2">Year</label> <select class="w-full px-4 py-3 bg-gray-700/50 text-white rounded-xl border border-gray-600 focus:ring-2 focus:ring-blue-500 focus:outline-none"><option disabled selected>Select year</option><option>1st Year</option><option>2nd Year</option></select></div> <div><label for="file" class="block text-gray-400 font-medium mb-2">Upload Files</label> <input type="file" multiple accept=".jpg,.jpeg,.png,.pdf" class="block w-full text-sm text-gray-300 file:py-2 file:px-4 file:border file:border-gray-600 file:rounded-md file:bg-gray-700 file:text-white hover:file:bg-blue-600 mb-4"></div> <!> <button type="submit" class="w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"><!></button></form></div></div>');function qe(K,O){se(O,!1);let S=d(""),f=d(""),m=d(""),b=d(""),c=d(""),y="",g=[],x=[],p=d(!1);const Q="djqao3rbs",R="ndc14-web-project";be(async()=>{try{const e=localStorage.getItem("jwtToken");if(e&&e.length>0&&ve(e)&&!ye(e)){y=xe(e);const t=await F.get(`https://ndc14backend.onrender.com/api/v2/users/id/${y}`);i(S,t.data.data.fullName)}}catch(e){console.error("Error fetching user data:",e)}});function W(e){const t=e.target;t&&t.files&&(x=Array.from(t.files))}async function X(){g=[],i(p,!0);const e=x.map(async t=>{const s=new FormData;s.append("file",t),s.append("upload_preset",R);try{const ie=await(await F.post(`https://api.cloudinary.com/v1_1/${Q}/auto/upload`,s,{headers:{"Content-Type":"multipart/form-data"},params:{resource_type:"auto",chunk_size:6e6}})).data;g.push(ie.secure_url),await u(`Uploaded file: ${t.name}`,"success")}catch(n){console.error(`Error uploading file: ${t.name}`,n),u(`Error uploading file: ${t.name}`,"error")}});await Promise.all(e),i(p,!1)}async function Z(e){if(e.preventDefault(),!a(f)||!a(m)||!a(b)||!a(c)){u("All fields are required","error");return}const t=new Date(a(m)).toLocaleDateString("en-GB").replace(/\//g,"/"),s={title:a(f),date:t,content:a(b),year:a(c)==="1st Year"?1:2,added_by:y,files:[]};x.length>0&&await X(),g.length>0&&g.forEach(n=>{s.files.push({filename:n})});try{await F.post("https://ndc14backend.onrender.com/api/v2/notices/",s,{params:{page:1}}),u("Notice added successfully!","success"),ge("/dashboard/notices")}catch(n){console.error("Error adding notice:",n),u("Error adding notice","error")}}me();var _=he(),U=o(_),h=r(o(U),2),ee=o(h);l(h);var w=r(h,2),k=o(w),C=r(o(k),2);H(C),l(k);var D=r(k,2),P=r(o(D),2);H(P),l(D);var E=r(D,2),q=r(o(E),2);pe(q),l(E);var N=r(E,2),Y=r(o(N),2);G(()=>{a(c),de(()=>{})});var j=o(Y);j.value=((j.__value="")==null,"");var $=r(j);$.value=($.__value="1st Year")==null?"":"1st Year";var z=r($);z.value=(z.__value="2nd Year")==null?"":"2nd Year",l(Y),l(N);var I=r(N,2),te=r(o(I),2);l(I);var B=r(I,2);{var ae=e=>{var t=_e();v(e,t)};L(B,e=>{a(p)&&e(ae)})}var A=r(B,2),re=o(A);{var oe=e=>{var t=V("Processing...");v(e,t)},le=e=>{var t=V("Add Notice");v(e,t)};L(re,e=>{a(p)?e(oe):e(le,!1)})}l(A),l(w),l(U),l(_),G(()=>{ce(ee,`Added by ${a(S)??""}`),A.disabled=a(p)}),T(C,()=>a(f),e=>i(f,e)),T(P,()=>a(m),e=>i(m,e)),T(q,()=>a(b),e=>i(b,e)),ue(Y,()=>a(c),e=>i(c,e)),M("change",te,W),M("submit",w,fe(Z)),v(K,_),ne()}export{qe as component};
